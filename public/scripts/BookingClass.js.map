{"version":3,"sources":["babel/BookingClass.js"],"names":["BookingCLass","store","date","Date","lang","today","moment","locale","currentMonth","format","datesOfWeeks","getDatesForWeek","currentDayOfWeek","getDay","query","$in","map","item","startTimeParts","endTimeParts","timeParts","i","push","busy","timeTable","timeTable15min","minDurationForService","seller","delta","timePartsForTable","timePartsI","changeStartEndTimeParts","weeksRange","setWeeksRange","selectedMonth","day","week","setTime","getTime","setHours","num","ds","d","dw","month","getMonth","getDate","year","getFullYear","dayOfYear","getDayOfYear","dStr","o","dateField","getDateStr","dateStr","substring","s","err","console","log","capitalizeFirstLetter","dayOfWeek","currentDayOfYear","storeSchedule","JSON","parse","stringify","dayoff","is","start","end","startDate","endDate","startDateString","endDateString","data","storeScheduleWeek","selectedWorkplace","entryTimeTable","forEach","p","j","out","dowArr","el","workplace","length","e","serviseLink","qty","usedTime","entries","getUsedTime","userId","user","_id","service","stuffNameL","stuffName","serviceLink","stuffLink","masterLink","masterUrl","masterName","masterNameL","masters","new","used","confirm","comment","zIndex","closed","backgroundcolor","noBorder","entry","filter","part","indexOf","h","Math","floor","m","h1","m1","tempArr","string","charAt","toUpperCase","slice","window","require","exports","init"],"mappings":"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","file":"BookingClass.js","sourcesContent":["'use strict';\r\n(function(){\r\n    class BookingCLass {\r\n        constructor (store,date){\r\n            if(!date){date = new Date()}\r\n            this.store = store;\r\n            this.lang=store.lang;\r\n            this.today = new Date(date);\r\n            this.date  = new Date(date);\r\n            moment.locale(this.lang)\r\n            this.currentMonth=moment(this.today).format('MMMM');\r\n            this.datesOfWeeks=this.getDatesForWeek(this.today);\r\n            this.currentDayOfWeek=this.date.getDay()\r\n            if(this.currentDayOfWeek==0){this.currentDayOfWeek=7;}\r\n            this.currentDayOfWeek--;\r\n            this.query={date:{$in:this.datesOfWeeks.map(function (item) {\r\n                return item.date\r\n            })}};\r\n\r\n            this.startTimeParts=36;\r\n            this.endTimeParts=72;\r\n            this.timeParts=[];\r\n            for(var i=0;i<96;i++){this.timeParts.push({busy:false,i:i})};\r\n            this.timeTable=['00:00','01:00','02:00','03:00','04:00','05:00','06:00','07:00','08:00','09:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00']\r\n            this.timeTable15min=[\r\n                '00:00','00:15','00:30','00:45',\r\n                '01:00','01:15','01:30','01:45',\r\n                '02:00','02:15','02:30','02:45',\r\n                '03:00','03:15','03:30','03:45',\r\n                '04:00','04:15','04:30','04:45',\r\n                '05:00','05:15','05:30','05:45',\r\n                '06:00','06:15','06:30','06:45',\r\n                '07:00','07:15','07:30','07:45',\r\n                '08:00','08:15','08:30','08:45',\r\n                '09:00','09:15','09:30','09:45',\r\n                '10:00','10:15','10:30','10:45',\r\n                '11:00','11:15','11:30','11:45',\r\n                '12:00','12:15','12:30','12:45',\r\n                '13:00','13:15','13:30','13:45',\r\n                '14:00','14:15','14:30','14:45',\r\n                '15:00','15:15','15:30','15:45',\r\n                '16:00','16:15','16:30','16:45',\r\n                '17:00','17:15','17:30','17:45',\r\n                '18:00','18:15','18:30','18:45',\r\n                '19:00','19:15','19:30','19:45',\r\n                '20:00','20:15','20:30','20:45',\r\n                '21:00','21:15','21:30','21:45',\r\n                '22:00','22:15','22:30','22:45',\r\n                '23:00','23:15','23:30','23:45',\r\n            ]\r\n            this.minDurationForService=store.seller.minDurationForService||15;\r\n            var delta=0;\r\n            //console.log(self.minDurationForService)\r\n            switch (this.minDurationForService){\r\n                case 30: delta=1;break;\r\n                case 60: delta=3;break;\r\n                case 90: delta=5;break;\r\n                case 120:delta=7;break;\r\n                default :delta=0;\r\n            }\r\n            this.timePartsForTable=[];\r\n            this.timePartsI=[];\r\n            for(var i=0;i<96;i=i+1+delta){\r\n                this.timePartsForTable.push(this.timeParts[i])\r\n                this.timePartsI.push(i)\r\n            }\r\n            \r\n            this.changeStartEndTimeParts()\r\n            this.weeksRange= this.setWeeksRange(this.today)\r\n        }\r\n        getDayOfYear(selectedMonth,day) {\r\n            if(selectedMonth==1){\r\n                return 31+day\r\n            }else if(selectedMonth==2){\r\n                return 31+29+day\r\n            }else if(selectedMonth==3){\r\n                return 31+29+31+day\r\n            }else if(selectedMonth==4){\r\n                return 31+29+31+30+day\r\n            }else if(selectedMonth==5){\r\n                return 31+29+31+30+31+day\r\n            }else if(selectedMonth==6){\r\n                return 31+29+31+30+31+30+day\r\n            }else if(selectedMonth==7){\r\n                return 31+29+31+30+31+30+31+day\r\n            }else if(selectedMonth==8){\r\n                return 31+29+31+30+31+30+31+31+day\r\n            }else if(selectedMonth==9){\r\n                return 31+29+31+30+31+30+31+31+30+day\r\n            }else if(selectedMonth==10){\r\n                return 31+29+31+30+31+30+31+31+30+31+day\r\n            }else if(selectedMonth==11){\r\n                return 31+29+31+30+31+30+31+31+30+31+30+day\r\n            }else{\r\n                return day;\r\n            }\r\n        }\r\n        setWeekDates(week) {\r\n            this.date = new Date(this.today)\r\n            if(week){\r\n                this.date.setTime(this.date.getTime() + (week*7)*86400000);\r\n                this.date.setHours(0)\r\n            }\r\n            this.currentMonth=moment(this.date).format('MMMM')\r\n            this.datesOfWeeks=this.getDatesForWeek(this.date);\r\n            this.currentDayOfWeek=this.date.getDay()\r\n            if(this.currentDayOfWeek==0){this.currentDayOfWeek=7;}\r\n            this.currentDayOfWeek--;\r\n            if(week){this.currentDayOfWeek==0;}\r\n            this.query={date:{$in:this.datesOfWeeks.map(function (item) {\r\n                return item.date\r\n            })}};\r\n        }\r\n        getDatesForWeek(date,num){\r\n            if(!num){num=7}\r\n            var ds=[];\r\n            var d= new Date(date)\r\n            var dw = date.getDay()\r\n            if(dw==0){dw=7}\r\n            for(var i=1;i<=num;i++){\r\n                d= new Date(date)\r\n                d.setTime(d.getTime() + (i-dw)*86400000);\r\n                d.setHours(0)\r\n                var month = d.getMonth()// + 1; //months from 1-12\r\n                var day = d.getDate();\r\n                var year = d.getFullYear();\r\n                var dayOfYear=this.getDayOfYear(month,day-1)\r\n                if(month<10){month='0'+month}\r\n                if(day<10){day='0'+day};\r\n                var dStr = 'date'+year+month+day;\r\n                moment.locale(this.lang)\r\n                var o={\r\n                    date:dStr,\r\n                    d:d,\r\n                    dayOfYear:dayOfYear,\r\n                    month:moment(d).format('MMMM'),\r\n                    dateField:this.getDateStr(d)\r\n                }\r\n                ds.push(o)\r\n            }\r\n            return ds;\r\n        }\r\n\r\n        getDateObj(dateStr) {\r\n            var year = dateStr.substring(4,8)\r\n            var month = dateStr.substring(8,10)\r\n            var day = dateStr.substring(10)\r\n            try{\r\n                var date = new Date(year,month,day)\r\n                moment.locale(this.lang)\r\n                var s =moment(date).format('ddd');\r\n                return s+'/'+day;\r\n            }catch(err){console.log(err);return 'error handle date'}\r\n        }\r\n        getDateStr(date) {\r\n            try{\r\n                var date = new Date(date)\r\n                moment.locale(this.lang)\r\n                var s =moment(date).format('dddd');\r\n                var d =moment(date).format('DD.MM.YY');\r\n                return capitalizeFirstLetter(s)+' ('+d+')';\r\n            }catch(err){console.log(err);return 'error handle date'}\r\n        }\r\n        changeStartEndTimeParts (date) {\r\n            if(!date){date=this.today}\r\n            var dayOfWeek = date.getDay();\r\n            var month = date.getMonth()\r\n            var day = date.getDate();\r\n            this.currentDayOfYear=this.getDayOfYear(month,day-1)\r\n            if(this.store.timeTable){\r\n                this.storeSchedule=JSON.parse(JSON.stringify(this.store.timeTable))\r\n                this.dayoff=(this.storeSchedule[dayOfWeek] && this.storeSchedule[dayOfWeek].is)?false:true;\r\n                var start = (this.storeSchedule[dayOfWeek] && this.storeSchedule[dayOfWeek].start)?this.storeSchedule[dayOfWeek].start:6\r\n                var end = (this.storeSchedule[dayOfWeek] && this.storeSchedule[dayOfWeek].end)?this.storeSchedule[dayOfWeek].end:20\r\n                this.startTimeParts=start *4\r\n                this.endTimeParts=end *4\r\n                for(dayOfWeek in this.store.timeTable){\r\n                    if(this.store.timeTable[dayOfWeek].start<start){\r\n                        start=this.store.timeTable[dayOfWeek].start;\r\n                    }\r\n                    if(this.store.timeTable[dayOfWeek].end>end){\r\n                        end=this.store.timeTable[dayOfWeek].end;\r\n                    }\r\n                }\r\n                this.startTimeParts=start *4\r\n                this.endTimeParts=end *4\r\n            }\r\n        }\r\n        setWeeksRange(today) {\r\n            var weeksRange= [{},{},{},{},{},{},{}]\r\n            //var tempFoo=this.getDatesForWeek;\r\n            for(var i=0;i<7;i++){\r\n                if(!i){\r\n                    var date = today;\r\n\r\n                }else{\r\n                    var date= new Date(today)\r\n                    date.setTime(date.getTime() + (i*7)*86400000);\r\n                    date.setHours(0)\r\n                }\r\n                var datesOfWeeks=this.getDatesForWeek(date);\r\n                weeksRange[i].startDate=datesOfWeeks[0].d\r\n                weeksRange[i].endDate=datesOfWeeks[6].d\r\n                moment.locale(this.lang)\r\n                weeksRange[i].startDateString=moment(datesOfWeeks[0].d).format('DD MMM')\r\n                weeksRange[i].endDateString=moment(datesOfWeeks[6].d).format('DD MMM')\r\n            }\r\n            return weeksRange\r\n        }\r\n        getBookingWeekScheldule(data,lang) {\r\n            var datesOfWeeks=this.datesOfWeeks;\r\n            var storeScheduleWeek=JSON.parse(JSON.stringify(this.store.timeTable));\r\n            let selectedWorkplace={'week':{}}\r\n            for(var dayOfWeek=0;dayOfWeek<7;dayOfWeek++){\r\n                var d = datesOfWeeks[dayOfWeek];\r\n                selectedWorkplace['week'][d.date]={}\r\n                selectedWorkplace['week'][d.date].entryTimeTable=JSON.parse(JSON.stringify(this.timeParts));\r\n                selectedWorkplace['week'][d.date].entryTimeTable.forEach(function (p,i) {\r\n                    p.date=d.date;\r\n                    if(storeScheduleWeek){\r\n                        // в self.storeSchedule 0 - это воскр у нас 0 - это понедельник\r\n                        var j = dayOfWeek+1;\r\n                        if(dayOfWeek==6){\r\n                            j=0;\r\n                        }\r\n                        if(!storeScheduleWeek[j].is || p.i<storeScheduleWeek[j].start*4 || p.i>=storeScheduleWeek[j].end*4){\r\n                            p.out=true;\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n            //console.log(selectedWorkplace)\r\n            var dowArr= datesOfWeeks.map(function (el) {\r\n                return el.date;\r\n            })\r\n            var workplace= selectedWorkplace;\r\n            for(var j=0;j<data.length;j++){\r\n\r\n                var e = data[j];\r\n                //console.log('j',j,e.stuffName,e._id)\r\n                /*if(e.date=='date20180707'){\r\n                    console.log(e)\r\n                }*/\r\n\r\n                var serviseLink=null;\r\n                if(!workplace.week[e.date]){continue}\r\n                for(var i=e.start;i<e.start+e.qty;i++){\r\n                    workplace.week[e.date].entryTimeTable[i].busy=true;\r\n                    if(i==e.start){\r\n                        if(workplace.week[e.date].entryTimeTable[i].usedTime){\r\n                            //console.log(workplace.week[e.date].entryTimeTable[i].service,workplace.week[e.date].entryTimeTable[i].masterName,e.date)\r\n                            /*console.log(workplace.week[e.date].entryTimeTable[i].service,workplace.week[e.date].entryTimeTable[i].masterName)\r\n                            console.log(e.service,e.masterName)*/\r\n                            if(!workplace.week[e.date].entryTimeTable[i].entries){\r\n                                workplace.week[e.date].entryTimeTable[i].entries=[]\r\n                            }\r\n                            let o={};\r\n                            o.usedTime=this.getUsedTime(e.start,e.qty);\r\n                            o.userId= e.user._id;\r\n                            o.service= (e.stuffNameL && e.stuffNameL[lang])?e.stuffNameL[lang]:e.stuffName;\r\n                            o.serviceLink= e.stuffLink;\r\n                            o.masterLink= '/master/'+e.masterUrl;\r\n                            o.masterName= (e.masterNameL && e.masterNameL[lang])?e.masterNameL[lang]:e.masterName;\r\n                            o.masters= (e.masters)?e.masters:null;\r\n\r\n                            o.new=true;\r\n                            o.qty=e.qty;\r\n                            o.used=e.used;\r\n                            o.confirm=e.confirm;\r\n                            o.comment=e.comment;\r\n                            o.zIndex=1;\r\n                            e.usedTime=workplace.week[e.date].entryTimeTable[i].usedTime;\r\n                            o.closed=e.closed;\r\n                            o.stringify=JSON.stringify(e);\r\n                            workplace.week[e.date].entryTimeTable[i].entries.push(o)\r\n                            \r\n                        }else{\r\n                            workplace.week[e.date].entryTimeTable[i].usedTime=this.getUsedTime(e.start,e.qty);\r\n                            workplace.week[e.date].entryTimeTable[i].userId= e.user._id;\r\n                            workplace.week[e.date].entryTimeTable[i].service= (e.stuffNameL && e.stuffNameL[lang])?e.stuffNameL[lang]:e.stuffName;\r\n                            workplace.week[e.date].entryTimeTable[i].serviceLink= e.stuffLink;\r\n                            workplace.week[e.date].entryTimeTable[i].masterLink= '/master/'+e.masterUrl;\r\n                            workplace.week[e.date].entryTimeTable[i].masterName= (e.masterNameL && e.masterNameL[lang])?e.masterNameL[lang]:e.masterName;\r\n                            workplace.week[e.date].entryTimeTable[i].masters= (e.masters)?e.masters:null;\r\n                            workplace.week[e.date].entryTimeTable[i].new=true;\r\n                            workplace.week[e.date].entryTimeTable[i].qty=e.qty;\r\n                            workplace.week[e.date].entryTimeTable[i].used=e.used;\r\n                            workplace.week[e.date].entryTimeTable[i].confirm=e.confirm;\r\n                            workplace.week[e.date].entryTimeTable[i].comment=e.comment;\r\n                            workplace.week[e.date].entryTimeTable[i].zIndex=1;\r\n                            workplace.week[e.date].entryTimeTable[i].closed=e.closed;\r\n                            e.usedTime=workplace.week[e.date].entryTimeTable[i].usedTime;\r\n                            workplace.week[e.date].entryTimeTable[i].stringify=JSON.stringify(e)\r\n                            if(e.service.backgroundcolor){\r\n                                workplace.week[e.date].entryTimeTable[i].backgroundcolor=e.service.backgroundcolor;\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                    if(e.service.backgroundcolor && !workplace.week[e.date].entryTimeTable[i].backgroundcolor){\r\n                        workplace.week[e.date].entryTimeTable[i].backgroundcolor=e.service.backgroundcolor;\r\n                    }\r\n\r\n                    if(i!=e.start){\r\n                        workplace.week[e.date].entryTimeTable[i].noBorder=true\r\n                    }\r\n                    workplace.week[e.date].entryTimeTable[i].entry=e;\r\n                }\r\n            }\r\n            var startTimeParts = this.startTimeParts;\r\n            var endTimeParts=this.endTimeParts;\r\n            var timePartsI=this.timePartsI;\r\n            for(var d in workplace.week){\r\n                workplace.week[d].entryTimeTable=workplace.week[d].entryTimeTable.filter(function (part) {\r\n                    if(timePartsI.indexOf(part.i)<0){\r\n                        return;\r\n                    }\r\n                    return part.i>=startTimeParts&&part.i<endTimeParts\r\n                })\r\n            }\r\n\r\n            return workplace.week\r\n        }\r\n        getUsedTime(start,qty) {\r\n            var end = start+qty;\r\n            var h = Math.floor(start/4);\r\n            var m = (start-h*4)*15||'00';\r\n            var h1 = Math.floor(end/4);\r\n            var m1 = (end-h1*4)*15||'00';\r\n            return h+'.'+m+' - '+h1+'.'+m1;\r\n        }\r\n        getTimePartsForTable(){\r\n            var startTimeParts = this.startTimeParts;\r\n            var endTimeParts=this.endTimeParts;\r\n            var timeTable15min=this.timeTable15min\r\n            var tempArr =  this.timePartsForTable.filter(function (part) {\r\n                return part.i>=startTimeParts&&part.i<endTimeParts\r\n            })\r\n            return tempArr.map(function (el) {\r\n                return timeTable15min[el.i]\r\n            })\r\n            \r\n        }\r\n\r\n\r\n    }\r\n    function capitalizeFirstLetter(string) {\r\n        return string.charAt(0).toUpperCase() + string.slice(1);\r\n    }\r\n\r\n    if(typeof window !== 'undefined'){\r\n        window.BookingCLass = BookingCLass;\r\n    } else {\r\n        var moment = require('moment')\r\n        exports.init=BookingCLass;\r\n    }\r\n\r\n\r\n})()"]}